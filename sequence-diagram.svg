<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1667" height="685"><desc>title%20Flow%0A%0AUser-%3EApp%3AInitiate%20sign%20in%0AApp-%3EAzure%20AD%20B2C%3ARedirect%20to%20Azure%20AD%20B2C%0AAzure%20AD%20B2C-%3ECriipto%3ARedirect%20to%20Criipto%20to%20sign%20in%20with%20MitID%0ACriipto-%3EAzure%20AD%20B2C%3AReturn%20claims%20with%20uuid%2C%20name%2C%20and%20cprNumberIdentifier%0AAzure%20AD%20B2C-%3EAzure%20AD%20B2C%3A%20Translate%20claims%0AAzure%20AD%20B2C-%3EAzure%20Function%3ACall%20Azure%20Function%20with%20issuerUserId%2C%20displayName%2C%20and%20civilRegistrationNumber%0AAzure%20Function-%3EAzure%20AD%3ALookup%20user%20on%20hashed%20civilRegistrationNumber%0AAzure%20Function-%3EAzure%20AD%3AIf%20found%2C%20update%20user%20with%20civilRegistrationNumberValidated%20(UTC%20Now)%0AAzure%20Function-%3EAzure%20AD%20B2C%3AReturn%20user%20with%20id%2C%20displayName%2C%20accountEnabled%2C%20and%20civilRegistrationNumberValidated%0AAzure%20AD%20B2C-%3EApp%3AReturn%20claims%0AApp-%3EUser%3ASigned%20in</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1667" height="685"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="810.3805520036445" y="24.50280495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Flow</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.36731041409375 95.887643371 L 41.36731041409375 685.5884825009999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 174.56989661480992 95.887643371 L 174.56989661480992 685.5884825009999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 388.41670888974477 95.887643371 L 388.41670888974477 685.5884825009999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 793.7523364722969 95.887643371 L 793.7523364722969 685.5884825009999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1105.489516718651 95.887643371 L 1105.489516718651 685.5884825009999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1609.951822768 95.887643371 L 1609.951822768 685.5884825009999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.782594461 L 74.56701917818751 51.782594461 L 74.56701917818751 95.887643371 L 8.167601650000002 95.887643371 L 8.167601650000002 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.8912972305" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 143.80397233557946 51.782594461 L 205.3358208940404 51.782594461 L 205.3358208940404 95.887643371 L 143.80397233557946 95.887643371 L 143.80397233557946 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="161.52766791607945" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">App</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 323.0301791417643 51.782594461 L 453.80323863772526 51.782594461 L 453.80323863772526 95.887643371 L 323.0301791417643 95.887643371 L 323.0301791417643 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="340.7538747222643" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Azure AD B2C</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 754.8475495832031 51.782594461 L 832.6571233613906 51.782594461 L 832.6571233613906 95.887643371 L 754.8475495832031 95.887643371 L 754.8475495832031 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="772.5712451637031" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Criipto</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1038.4673439652995 51.782594461 L 1172.5116894720027 51.782594461 L 1172.5116894720027 95.887643371 L 1038.4673439652995 95.887643371 L 1038.4673439652995 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1056.1910395457994" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Azure Function</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1560.860924428711 51.782594461 L 1659.0427211072893 51.782594461 L 1659.0427211072893 95.887643371 L 1560.860924428711 95.887643371 L 1560.860924428711 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1578.584620009211" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Azure AD</text></g></g><g><g><g><rect fill="white" stroke="none" x="60.69730098576042" y="128.558049971" width="94.54260505738281" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="63.14758148076042" y="143.259732941" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Initiate sign in</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.36731041409375 149.793814261 L 161.12057923114327 149.793814261" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(174.56989661480992,149.793814261) translate(-174.56989661480992,-149.793814261)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 160.95722719814324 142.98747955266666 L 174.56989661480992 149.793814261 L 160.95722719814324 156.60014896933333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="193.8998871864766" y="174.296619211" width="175.18683113160156" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="196.3501676814766" y="188.99830218099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Redirect to Azure AD B2C</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 174.56989661480992 195.532383501 L 374.9673915060781 195.532383501" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(388.41670888974477,195.532383501) translate(-388.41670888974477,-195.532383501)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 374.8040394730781 188.72604879266666 L 388.41670888974477 195.532383501 L 374.8040394730781 202.33871820933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="464.3894759506693" y="220.035188451" width="253.39009346070313" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.8397564456693" y="234.736871421" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Redirect to Criipto to sign in with MitID</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 388.41670888974477 241.270952741 L 780.3030190886302 241.270952741" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(793.7523364722969,241.270952741) translate(-793.7523364722969,-241.270952741)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 780.1396670556302 234.46461803266666 L 793.7523364722969 241.270952741 L 780.1396670556302 248.07728744933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="407.7466994614115" y="265.77375769099996" width="366.6756464392187" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="410.1969799564115" y="280.47544066099994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return claims with uuid, name, and cprNumberIdentifier</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 793.7523364722969 287.009521981 L 401.8660262734114 287.009521981" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(388.41670888974477,287.009521981) translate(-388.41670888974477,-287.009521981)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 402.02937830641145 280.20318727266664 L 388.41670888974477 287.009521981 L 402.02937830641145 293.8158566893333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="407.7466994614114" y="311.512326931" width="111.07803596558594" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="410.19697995641144" y="326.214009901" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Translate claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 388.41670888974477 332.748091221 L 453.7575220897448 332.748091221 L 453.7575220897448 353.983855511 L 401.8660262734114 353.983855511" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(388.41670888974477,353.983855511) translate(-388.41670888974477,-353.983855511)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 402.02937830641145 347.17752080266666 L 388.41670888974477 353.983855511 L 402.02937830641145 360.79019021933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="480.1114138521666" y="378.486660461" width="533.6833979040625" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="482.5616943471666" y="393.18834343099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Call Azure Function with issuerUserId, displayName, and civilRegistrationNumber</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 388.41670888974477 399.722424751 L 1092.0401993349842 399.722424751" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1105.489516718651,399.722424751) translate(-1105.489516718651,-399.722424751)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1091.8768473019843 392.91609004266667 L 1105.489516718651 399.722424751 L 1091.8768473019843 406.52875945933334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1199.2182041897318" y="424.225229701" width="317.0049311071875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1201.6684846847318" y="438.92691267099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Lookup user on hashed civilRegistrationNumber</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1105.489516718651 445.460993991 L 1596.5025053843333 445.460993991" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1609.951822768,445.460993991) translate(-1609.951822768,-445.460993991)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1596.3391533513334 438.65465928266667 L 1609.951822768 445.460993991 L 1596.3391533513334 452.26732869933335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1124.8195072903177" y="469.963798941" width="465.8023249060156" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1127.2697877853177" y="484.665481911" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If found, update user with civilRegistrationNumberValidated (UTC Now)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1105.489516718651 491.199563231 L 1596.5025053843333 491.199563231" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1609.951822768,491.199563231) translate(-1609.951822768,-491.199563231)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1596.3391533513334 484.3932285226667 L 1609.951822768 491.199563231 L 1596.3391533513334 498.00589793933335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="454.54592312951036" y="515.702368181" width="584.814379349375" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="456.9962036245104" y="530.404051151" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return user with id, displayName, accountEnabled, and civilRegistrationNumberValidated</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1105.489516718651 536.938132471 L 401.8660262734114 536.938132471" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(388.41670888974477,536.938132471) translate(-388.41670888974477,-536.938132471)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 402.02937830641145 530.1317977626667 L 388.41670888974477 536.938132471 L 402.02937830641145 543.7444671793334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="234.2363129677266" y="561.440937421" width="94.51397956910156" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="236.6865934627266" y="576.1426203909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 388.41670888974477 582.676701711 L 188.01921399847657 582.676701711" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(174.56989661480992,582.676701711) translate(-174.56989661480992,-582.676701711)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 188.1825660314766 575.8703670026666 L 174.56989661480992 582.676701711 L 188.1825660314766 589.4830364193333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="74.95283992619011" y="607.1795066609999" width="66.03152717652344" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="77.40312042119011" y="621.8811896309999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Signed in</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 174.56989661480992 628.4152709509999 L 54.81662779776042 628.4152709509999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(41.36731041409375,628.4152709509999) translate(-41.36731041409375,-628.4152709509999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 54.97997983076042 621.6089362426666 L 41.36731041409375 628.4152709509999 L 54.97997983076042 635.2216056593332 Z"/></g></g></g><g/><g/><g/><g/><g/><g/></g></svg>